<p id="notice"><%= notice %></p>

<p>
  <b>User:</b>
  <%= @post.user.name %>
</p>  

<p>
  <b>Title:</b>
  <%= @post.title %>
</p>

<p>
  <b>Body:</b>
  <%= @post.body %>
</p>
<% i=0 %>
<% count=0 %>
<% @post.likes.each do |like| %>
  <% count +=1 %>
  <% if like.user_id == current_user.id %>
    <% i=1 %>
    <%= link_to 'Unlike', post_like_path(@post, like), method: :delete %>  
  <% else %>
    <% i=0 %>
  <% end %>
<% end %>
<% if i==0 %>
  <%= link_to 'Like', new_post_like_path(@post) %>&nbsp;&nbsp;
<% end %>
Total Likes <%= count %>
<h2> Comments </h2>
<% @post.comments.each do|comment| %>
  <% if comment.status == true %>
  
    <p>
      <b><%= comment.user.name %></b>
      :--  
      <%= comment.content %>
      :-- 
      <%= comment.post_date %><br/>
      <% j=0 %>
      <% countt=0 %>
      <% comment.likes.each do |likee| %>
        <% countt+=1 %>
        <% if likee.user_id == current_user.id %>
          <% j=1 %>
          <%= link_to 'Unlike', post_comment_likecomment_path(@post, comment, likee), method: :delete %>
        <% else %>
          <% j=0 %>
        <% end %>
      <% end %>
      <% if j==0 %>
      <%= link_to 'Like', new_post_comment_likecomment_path(@post, comment) %>
      <% end %>
      Total likes <%= countt %> 
      <% if comment.commenter_id == current_user.id || @post.user.id == current_user.id %>
      <td><%= link_to 'Destroy', [comment.post, comment], method: :delete, data: { confirm: 'Are you sure?' } %></td>
      <% end %>
    </p>
  <% else %>
    <% if current_user.id == comment.commenter_id%>
     <b><%= comment.user.name %></b>
      Your comment's Request is pending <br/>
    <% end %>  
  <% end %> 
<% end %>     
<h2> Add a comment:</h2>
<%= form_for([@post, @post.comments.build]) do |f| %>
  <div class="field">
    <%= f.label :content %><br />
    <%= f.text_area :content %>
  </div>
  <div class="field">
    <%= f.label :date %><br />
    <%= Time.now.strftime("%d/%m/%Y") %>
    <%= f.hidden_field(:post_date, :value => Time.now.strftime("%d/%m/%Y")) %>
   </div>
  <div class="field">
    <%= f.hidden_field :post_id %>
  </div>  
  <div class="field">
    <%= f.hidden_field(:status, :value => false) %>
  </div>
  <div class="field">
    <%= f.hidden_field(:commenter_id, :value => current_user.id) %>
  </div>  
  <div class="actions">
    <%= f.submit %>
  </div>  
<% end %>

<%= link_to 'Edit', edit_post_path(@post) %> |
<%= link_to 'Back', posts_path %>
<%= link_to 'Home page', root_path %>


